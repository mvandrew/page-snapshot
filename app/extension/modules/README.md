# Модули Chrome Extension

## Logger - Централизованная система логирования

### Описание
Модуль `logger.js` предоставляет централизованную систему логирования для всего расширения с единообразным форматированием и управлением уровнями логирования.

### Основные возможности

#### 1. Единый префикс
Все логи автоматически получают префикс `[timestamp] Page Snapshot [LEVEL]: message`

#### 2. Уровни логирования
- `ERROR` (0) - Критические ошибки
- `WARN` (1) - Предупреждения  
- `INFO` (2) - Информационные сообщения (по умолчанию)
- `DEBUG` (3) - Отладочная информация

#### 3. Автоматическое управление уровнями
Уровень логирования автоматически настраивается на основе настройки `enableDebug` из storage.

### Использование

#### Базовые методы
```javascript
// Ошибки (всегда показываются)
logger.error('Произошла ошибка:', error);

// Предупреждения
logger.warn('Потенциальная проблема:', warning);

// Информация (по умолчанию)
logger.info('Операция выполнена успешно');

// Отладка (только при enableDebug = true)
logger.debug('Детальная информация:', data);
```

#### Дополнительные методы
```javascript
// Группировка логов
logger.group('Операция сохранения', () => {
    logger.info('Начало сохранения');
    logger.debug('Данные:', data);
    logger.info('Сохранение завершено');
});

// Сворачиваемая группа
logger.groupCollapsed('Детали обработки', () => {
    logger.debug('Шаг 1:', step1);
    logger.debug('Шаг 2:', step2);
});

// Таблица данных
logger.table(data, 'Результаты обработки');

// Объект с форматированием
logger.object(complexObject, 'Сложный объект');

// Стек вызовов
logger.trace('Точка вызова');

// Измерение времени
logger.time('Операция');
// ... выполнение операции ...
logger.timeEnd('Операция');
```

### Интеграция с настройками

Логгер автоматически синхронизируется с настройкой `enableDebug`:
- При `enableDebug: true` - уровень DEBUG (показываются все логи)
- При `enableDebug: false` - уровень INFO (скрываются DEBUG логи)

### Обновление настроек отладки

```javascript
// Обновить настройки отладки программно
logger.updateDebugSettings(true);  // Включить отладку
logger.updateDebugSettings(false); // Выключить отладку
```

### Примеры использования в коде

```javascript
// Вместо console.log
console.log('Page Snapshot: Operation completed');
// Стало
logger.info('Operation completed');

// Вместо console.error  
console.error('Page Snapshot: Error occurred:', error);
// Стало
logger.error('Error occurred:', error);

// Отладочная информация
if (enableDebug) {
    console.log('Debug info:', data);
}
// Стало
logger.debug('Debug info:', data);
```

### Преимущества

1. **Единообразие** - все логи имеют одинаковый формат
2. **Централизованное управление** - один префикс для всего расширения
3. **Гибкость уровней** - легко включать/выключать отладку
4. **Дополнительные возможности** - группировка, таблицы, измерение времени
5. **Автоматическая синхронизация** - с настройками расширения
6. **Производительность** - DEBUG логи не выполняются при выключенной отладке

### Миграция существующего кода

Все `console.log`, `console.error`, `console.warn` в модулях расширения заменены на соответствующие методы логгера:

- `console.log` → `logger.info` (для обычных сообщений) или `logger.debug` (для отладочных)
- `console.error` → `logger.error`
- `console.warn` → `logger.warn`

Префикс "Page Snapshot" больше не нужно добавлять вручную - он добавляется автоматически.